<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Books — Michael C. Barros</title>
  <meta name="description" content="Published and forthcoming work on religion and popular culture." />
  <link rel="stylesheet" href="./style.css" />
  <style>
    :root{ --ink:#111827; --muted:#6b7280; --ring:rgba(15,118,110,.25); }
    .shell{max-width:1060px;margin:0 auto;padding:20px 20px 48px}
    .site-header{display:flex;align-items:center;justify-content:space-between;padding:10px 0}
    .brand{font-weight:700;text-decoration:none;color:var(--ink)}
    .nav{display:flex;gap:18px;flex-wrap:wrap}
    .nav a{color:var(--ink);text-decoration:none}
    .nav a[aria-current="page"]{text-decoration:underline}

    .hero--compact{padding:18px 0 6px}
    .muted{color:var(--muted)}
    .divider{height:1px;background:#e5e7eb;margin:24px 0}

    /* Featured block */
    .book-hero{display:grid;gap:18px;align-items:center}
    @media(min-width:900px){.book-hero{grid-template-columns:220px 1fr}}
    .book-cover{width:100%;height:auto;border-radius:10px;box-shadow:0 10px 26px rgba(0,0,0,.12)}
    .cta-row{display:flex;gap:.6rem;flex-wrap:wrap;margin-top:.6rem}
    .btn{display:inline-block;padding:.7rem 1.1rem;border-radius:.7rem;background:#111827;color:#fff;text-decoration:none;font-weight:700}
    .btn:hover{filter:brightness(1.08)}
    .btn.ghost{background:transparent;color:#111827;border:2px solid #111827}

    /* Grid of other books */
    .grid{display:grid;gap:16px}
    @media(min-width:900px){.grid.cols-3{grid-template-columns:repeat(3,1fr)}}
    .card{background:#fff;border:1px solid rgba(160,125,59,.25);border-radius:12px;padding:16px;transition:.2s;color:inherit;text-decoration:none;display:block}
    .card:hover{border-color:rgba(160,125,59,.5);box-shadow:0 10px 26px rgba(0,0,0,.08);transform:translateY(-2px)}
    .badge{display:inline-block;border:1px solid rgba(160,125,59,.35);color:#0f766e;font-family:'IBM Plex Mono',monospace;font-size:.72rem;padding:.15rem .45rem;border-radius:.4rem;margin-bottom:.35rem}
    .empty{padding:1rem;border:1px dashed #e5e7eb;border-radius:.75rem;background:#fafafa}
  </style>
</head>
<body>
  <div class="shell">
    <!-- Header -->
    <header class="site-header">
      <a class="brand" href="./index.html">Michael C. Barros</a>
      <nav class="nav" aria-label="Main">
        <a href="./about.html">About</a>
        <a href="./books.html" aria-current="page">Books</a>
        <a id="nav-blog" href="https://mythonoesis.substack.com/" target="_blank" rel="noopener">Blog</a>
        <a href="./projects.html">Projects</a>
        <a id="nav-research" href="https://www.researchgate.net/" target="_blank" rel="noopener">Research</a>
        <a href="./contact.html">Contact</a>
      </nav>
    </header>

    <!-- Title -->
    <section class="hero--compact">
      <h1>Books</h1>
      <p class="muted">Published and forthcoming work on religion and popular culture.</p>
    </section>

    <div class="divider"></div>

    <!-- Featured -->
    <section aria-labelledby="featured">
      <h2 id="featured">Featured</h2>
      <div id="book-hero" class="book-hero" style="margin-top:.5rem">
        <!-- Fallback until data arrives -->
        <img class="book-cover" src="./assets/images/books/placeholder.jpg" alt="Book cover" loading="lazy">
        <div>
          <h3>Current Book</h3>
          <p class="muted">Add book details in <code>js/data/data.js</code>.</p>
          <div class="cta-row">
            <a class="btn" href="#all-books">All books</a>
            <a class="btn ghost" href="#" id="buy-ghost">Buy on Amazon</a>
          </div>
        </div>
      </div>
    </section>

    <div class="divider"></div>

    <!-- List -->
    <section aria-labelledby="more" id="all-books">
      <h2 id="more">More Books</h2>
      <div id="books-grid" class="grid cols-3" style="margin-top:.6rem">
        <div class="empty" style="grid-column:1/-1">No additional books yet.</div>
      </div>
    </section>

    <div class="divider"></div>

    <footer class="footer" style="text-align:center;color:#6b7280">© <span id="year"></span> Michael C. Barros</footer>
  </div>

  <!-- Correct path to your data -->
  <script defer src="./js/data/data.js"></script>

  <script>
    document.getElementById('year').textContent = new Date().getFullYear();

    // Read data
    const DATA = window.SITE_DATA || {};
    const BOOKS = Array.isArray(DATA.books) ? DATA.books : (window.BOOKS || []);

    // Render featured
    (function(){
      if (!BOOKS.length) return;
      const featured = BOOKS.find(b => b.featured) || BOOKS[0];
      const hero = document.getElementById('book-hero');

      const cover = featured.cover || featured.image || './assets/images/books/placeholder.jpg';
      const learn = featured.url || './books.html';
      const buy   = (featured.buy_links && featured.buy_links[0]) ? featured.buy_links[0] : null;

      hero.innerHTML = `
        <img class="book-cover" src="${cover}" alt="${featured.title} cover" loading="lazy">
        <div>
          <h3>${featured.title}</h3>
          <p class="muted">${featured.summary || featured.description || ''}</p>
          <div class="cta-row">
            <a class="btn" href="#all-books">All books</a>
            ${buy ? `<a class="btn ghost" href="${buy.url}" target="_blank" rel="noopener">${buy.label || 'Buy on Amazon'}</a>` : ''}
          </div>
        </div>
      `;
    })();

    // Render list of other books
    (function(){
      const grid = document.getElementById('books-grid');
      if (!BOOKS.length) return;

      const list = BOOKS.slice().filter(b => !b.featured);
      if (!list.length) { grid.innerHTML = `<div class="empty" style="grid-column:1/-1">No additional books yet.</div>`; return; }

      grid.innerHTML = '';
      list.forEach(b=>{
        const buy = (b.buy_links && b.buy_links[0]) ? b.buy_links[0] : null;
        const card = document.createElement('a');
        card.className = 'card';
        card.href = b.url || (buy ? buy.url : '#');
        if (b.url || buy) { card.target = '_blank'; card.rel = 'noopener'; }
        card.innerHTML = `
          <span class="badge">${b.status || 'Book'}</span>
          <h3>${b.title}</h3>
          <p class="muted">${b.summary || b.description || ''}</p>
        `;
        grid.appendChild(card);
      });
    })();
  </script>
</body>
</html>
